data_heart <- read.table ("./Heart_expression_matrix.tsv")
data_fibroblast <- read.table ("./fibroblast_expression_matrix.tsv")
n <- ncol (data_heart)
m <- ncol (data_fibroblast)
number_samples <- min(n, m)
names <- rownames(data_heart)
data <- cbind(data_fibroblast[ ,c(1:number_samples)], data_heart[ ,c(1:number_samples)])
data_matrix <- data.matrix(data)
library(edgeR)
group <- c(rep("fibroblast", number_samples), rep("control", number_samples))
data_DGEList <- DGEList(data_matrix, group=group)
data_DGEList <- calcNormFactors(data_DGEList, method="TMM")
data_DGEList <- estimateCommonDisp(data_DGEList)
data_DGEList <- exactTest(data_DGEList)
data_DGEList
write.table(data_DGEList, file="./DE_edgeR_cheart_fibroblast.txt", sep="\t", row.names=TRUE) 
data <- read.table("./DE_edgeR_cheart_fibroblast.txt")
data_with_diff_genes <- data[is.na(data$PValue)==FALSE & data$PValue <0.05]
write.table(data_with_diff_genes, file="./DE_edgeR_with_diff_genes_cheart_fibroblast.txt", sep="\t", row.names=TRUE)
 
